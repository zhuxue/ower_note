# 01-移动 Web 简介

## 一 常见术语

### 1.1 长度单位

移动设备与 PC 设备的最大差异在于屏幕的大小，包含两个关键因素：

- 屏幕尺寸：屏幕对角线的长度，一般使用英寸来度量
- 屏幕分辨率：屏幕水平和垂直方向的像素数，一般使用 px 来度量

手机屏幕大小如 4.7、5.0、6.0 这些其实是其对角线的长度，单位一般是英寸：

![屏幕大小](../images/css/moblie-01.png)

所以长度单位可以分为：

- 绝对长度单位：in 英寸、cm 厘米
- 相对长度单位：px 像素、em、pt

px 是最常用的长度单位，此外还有 em、pt（点）、in（英寸）、cm（厘米）等可以作为开发中的长度单位。

### 1.3 分辨率与 Retina

屏幕分辨率即屏幕的像素点数，比如 iPhone3G/S 和 iPhone4/S 的屏幕尺寸都是 3.5 英寸(in)，但是其分辨率却分别为`480(高)*320px(宽)`、`960*640px`，所以像素其实是一个相对长度单位，英寸是一个绝对长度的单位。

每英寸所拥有的像素数目越大，屏幕也越清晰，这称为 PPI。

比如 iPhone4 的宽高像素分别是：960、640，那么根据勾股定理，可以得到其对角线的像素，而对角线的长度正好是 iPhone4 标明的 3.5 英寸，那么 iPhone4 的 PPI 就是：

$\sqrt{ 960^2 + 640^2 } \div 3.5 = 330$

苹果将拥有较高 PPI（大于 320）的屏幕称呼为视网膜屏幕（Retina）。

### 1.4 关于像素

**物理像素**：即物理分辨率，是设备屏幕实际拥有的像素点，比如 iPhone6 的像素是：`1334*750`，其实就是其在高度上有 1334 个像素点，在宽度上有 750 个像素点，其总共拥有的像素点是：`1334*750`。

**设备独立像素**：即逻辑分辨率，即当前设备能容纳的 CSS 像素。如手机 300-400 之间，10 寸平板在 700-800 之间，13 寸笔记本长边是 1280。

比如：iPhone4/S 的像素是`960*640px`，但是在 Chrome 浏览器上模拟的大小却是`480*320`，这既是设备独立像素，Chrome 上的大小是当前的浏览器能装下的视口大小，与像素没有关系！

**像素比 dpr**：从上述示例看出，设备独立像素和物理像素往往是成比例的。当像素比为 1：1 视，1 个物理像素就用来显示 1 个设备独立像素，当像素比为 2：1 时，就需要使用 4 个物理像素显示 1 个设备独立像素（长 2 倍，宽 2 倍）。**人眼能够识别的 dpr 最大是 2！**，所以像素比并不能决定屏幕的清晰度，PPI 才是核定屏幕清晰的最好评判方式。

**CSS 像素**：CSS 像素即开发中使用的单位 px，CSS 中 1px 并不等于设备的 1px，因为在 Retina 屏中，分辨率提高了一倍，但是屏幕尺寸未发生变化，即同样大小的屏幕下，Retina 屏像素多了一倍，这时，1 个 CSS 像素即是 4 个物理像素。

贴士：开发中，PSD 设计稿的像素是物理像素，即真实分辨率，一般是 1080px。

## 二 移动端 web 技术方案

### 2.0 视口

PC 端的页面直接放置在手机端显示，由于页面过大无法显示全，就会出现滚动条，为了解决该问题，引入了**视口**。

> 视口：viewport，即浏览器 显示页面内容的屏幕区域，分为 布局视口、视觉视口、理想视口。

举例 1：Chrome 上，iPhone6 的设备宽度是 375，现在书写一个 div，宽度为 400px，该 div 仍然能够全部显示在界面上，这是因为虽然设备宽度没变，但是用户看到的地方被缩小为了一个 980 宽度的窗口，即视口！

**布局视口**（layout viewport）：在手机中，一般默认会有一个 980px 分辨率的视口，所以 PC 端网页都可以显示在手机中，但是此时 PC 端的页面在手机端看起来就会变小，往往需要手动缩放才能看清。

![布局视口](../images/css/viewport-01.png)

举例 2：当我们手动设定一个网页的视口之后，视口宽度等于设备宽度，且`initial-scale=1.0`即 1 比 1 还原，那么举例 1 中的界面就无法显示超过其设备宽度的区域了。

**视觉视口**(visual viewport)：用户在手机端能看到的页面区域。

**理想视口**(ideal viewport)：能够在视觉视口内显示一个完整的页面，又不会像布局视口那样大需要手指捏着屏幕看。在代码上，即所做的页面不再是默认 980px 这样的设定好的，而是与设备的视口宽度相同。

为了实现理想视口，需要手动添加 meta 视口标签 通知浏览器操作，该标签的目的是让布局视口的宽度和理想视口的宽度一致，即设备有多宽，布局的视口就有多宽。

视口设置示例：

```html
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
```

content 常见属性：

```txt
width               默认为device-width，即为理想视口，如果不加，默认按照 980px 显示，页面元素就会变得很小
user-scalable       是否允许用户缩放
initial-scale       最初的缩放比例，比如值为2，则页面一打开，缩放为默认大小的2倍显示
```

标准的 viewport 设置推荐如下：

```txt
视口宽度和设备保持一致
视口的默认缩放比例为1.0
不允许用户自行缩放
最大允许缩放比例为1.0
最小允许缩放比例为1.0
```

## 2.1 移动 web 解决方案

网页如果要在移动端通过浏览器、APP 内嵌页显示，则需要考虑移动端的适配问题。目前有两种选型方案：

- **独立页面（主流方案）**：移动端页面采用专门的网页来展示，如 `m.jd.com`。
- **响应式页面**：PC 与移动端共用一个网页，根据屏幕宽度进行响应式适配，开发难度较大。

移动端浏览器内核一般为 webkit 内核，可以较大范围的使用 C3 技术，所以像弹性布局、媒体查询等技术都可以使。

常见的布局方式的实现有：

- 方式一：固定大小方式。最小宽度为基准进行布局，这样在大屏幕设备上顶多出现留白，不会出现布局错误。但是类似图片这样的元素随着设备屏幕的放大，越来越不清晰。
- 方式二：百分比方式。具有一定的局限性，往往像素方式进行配合使用。
- 方式三：rem 方式，推荐！根据字体随着设备大小的改变而改变，设定元素的大小。

## 三 移动 web 常见问题

### 3.1 移动端的 CSS reset 文件

初始化移动端的 css，推荐使用第三方库:`normalize.css`，网址为：<https://github.com/necolas/normalize.css>。该库保留了一些有价值的默认值，修改了一部分浏览器 bug，且具备模块化开发方案！

### 3.2 倍图

在标准视口设置中，一般使用倍图来解决图片在视网膜屏中变模糊的问题，如`50px*50px`的 PC 端图片，需要一个 `100px*100px`图片，并将该图片手动缩小为`50px*50px`适配 iphone8，如下所示：

```css
/* 现在要展示的是50*50的图片，现在需要使用二倍图 100*100，然后手动将其修改为50*50 */
img {
  width: 50px;
  height: 50px;
}
```

### 3.3 背景缩放

图片可以缩放，背景在 C3 中也可以实现缩放，`background-size`属性可以设置背景图像的尺寸:

```css
/* 分别是背景图宽度 高度的缩放 */
background-size: 100px 200px;

/* 只写一个参数则是 宽度缩放,高度则会按照等比例缩放 */
background-size: 100px;

/* 相当于父盒子进行比例缩放 */
background-size: 20%;

/* cover: 将图像沿着两个方先无限拉伸盖住盒子,图片会出现被遮挡部分 */
background-size: cover;

/* contain: 将图像等比例拉伸,宽度或者高度有一个铺满盒子,图片会完整显示,但是可能不会完全覆盖为背景 */
background-size: contain;
```

### 3.4 二倍精灵图位置

2 倍精灵图不能在 PS 中直接测量，需要先将 2 倍精灵图等比例缩放为原来的一半（即精灵图的宽度改为原来的一半）。
